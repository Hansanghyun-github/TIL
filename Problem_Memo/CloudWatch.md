## cloud-watch-agent가 로그 수집을 못한다.

### 1. 로그 파일에 대한 읽기 권한 없음

/opt/aws/amazon-cloudwatch-agent/logs/amazon-cloudwatch-agent.log 파일이  
클라우드 워치의 로그 파일이다.

이를 확인해보니,  
권한이 없어서 로그를 수집하지 못하는 것을 확인했다.

> 소유자에 대한 읽기 권한은 줬지만,  
> 다른 사용자에 대한 읽기 권한이 없어서 발생한 문제였다.  
> (cloud-watch-agent는 기타 사용자로 취급되는 것 같다)

### 2. 로그 파일의 상위 디렉토리에 대한 읽기 권한 없음

상위 디렉토리에 대한 읽기 권한이 없으면  
클라우드 워치 로그에 에러가 발생하지 않는다.

> 그래서 이 문제를 바로 캐치하지 못했다.

### 3. 클라우드워치는 특정 로그파일을 추적해서 가져오는데, 이떄 로그 파일이 꽉차서 새로 생성되면, 권한이 바껴서 agent가 수집을 못한다.

/etc/logrotate.d - 파일 꽉찼을 때 로테이션 규칙 정해주는 곳

여기서 기타 사용자에 대한 읽기 권한을 추가해 줬다.