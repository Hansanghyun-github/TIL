## Redis 영속성

> Redis는 In-memory 데이터베이스이기 때문에 서버가 종료되면 데이터가 모두 사라진다.  
> 이를 해결하기 위해 영속성을 지원한다.

Redis는 지속성을 보장하기 위해 데이터를 디스크에 저장할 수 있다.

이때 사용하는 방법은 크게 2가지가 있다.

1. RDB(Redis DataBase)
2. AOF(Append Only File)

### RDB

주기적으로 스냅샷을 찍어 디스크에 저장하는 방식이다.

### AOF

명령어를 로그로 저장하는 방식이다.  
데이터를 변경하는 커맨드가 들어오면, 모든 커맨드를 로그로 저장한다.

### RDB vs AOF

1. RDB
- 장점: 파일 크기가 작다.
- 단점: 데이터 손실이 발생할 수 있다.

2. AOF
- 장점: 데이터 손실이 적다.
- 단점: 파일 크기가 크다.

### RDB, AOF 선택 기준

1. 백업은 필요하지만 어느 정도의 데이터 손실이 발생해도 괜찮은 경우  
   RDB 단독 사용  
   redis.conf 설정: `SAVE 900 1` (15분 동안 1개 이상의 변경이 있을 경우 스냅샷 저장)
2. 장애 상황 직전까지의 모든 데이터가 보장되어야 하는 경우  
   AOF 사용  
   APPENDSYNC 설정: `APPENDSYNC EVERYSEC` (1초마다 로그 저장)
3. RDB와 AOF를 함께 사용하는 경우  
   RDB와 AOF를 함께 사용하면 RDB로 복구하고 AOF로 잃어버린 데이터를 복구할 수 있다.

---

