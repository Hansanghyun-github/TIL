## 무중단 배포 

스프링 서버의 다운 타임을 없애기 위해  
무중단 배포를 구현해보자.

1. 새로운 버전 서버 실행(8082)
2. 8082 포트로 헬스 체크
3. nginx reload(기존 8081 -> 8082)
4. 80 포트로 헬스 체크
5. 기존 서버 종료(8081)

### 추가 작업

모니터링 포트 설정 - 시크릿 파일에 별도로,

nginx 모니터링 포트 설정

---

### 문제 1 - 헬스 체크 기능

현재 nginx가 리버스 프록시 기능을 하고 있어서  
스프링 서버로 직접 요청하지 않고  
80번 포트로 요청하면 nginx가 알아서 요청을 전달해주는데,  

새로운 버전의 서버를 올리면  
이 서버의 상태가 어떤지를 확인할 수 있는 헬스 체크 기능이 필요하다.

> 일단은 인바운드 새로 추가하고,  
> Thread.sleep(1000)을 넣어서 1초마다 체크하도록 구현했다.

> 그 다음 업그레이드  
> (스프링 서버에서 직접 로드 완료 알림 보내서,  
> 로컬호스트에서 헬스체크를 하는 방식으로 변경)

---

### 문제 2 - 스카우터 모니터링 전용 포트 설정

스카우터 모니터링을 위해 별도의 포트를 열어야 한다.

> 기존 서버는 6100 포트로 모니터링 중이다.

