# 20 OOP와 FP의 조화: 자바와 스칼라 비교

스칼라는 객체지향과 함수형 프로그래밍을 혼합한 언어이다.

보통 정적 형식의 프로그래밍 언어로 함수형의 기능을 수행하면서도 JVM에서 수행되는 언어이므로 자바느낌을 원하는 프로그래머가 찾는다.

즉 스칼라는 복잡한 형식 시스템, 형식 추론, 패턴 매칭, DSL을 단순하게 정의할 수 있는 구조 등을 제공한다.

이 장에서는 자바의 새로운 기능과 스칼라의 기능을 비교하면서, 자바의 한계가 무엇인지 확인해본다.

## 스칼라 소개

다음은 명령형으로 문장을 출력하는 스칼라 프로그램이다.

```scala
object Beer{
    def main(args: Array[String]){
        var n: int = 2
        while(n <= 6){
            println(s"Hello ${n} bottles of bear")
            n+=1
        }
    }
}
```

위 코드는 자바와 아주 비슷하다.

(자바의 String s와 달리 s:String 이라는 문법 구조를 갖는다.)

main 메서드는 반환값이 없는데 자바에서는 void를 사용했겠지만 스칼라에서는 아무것도 선언하지 않았다.

스칼라에서는 object로 직접 싱글턴 객체를 만들 수 있다. 위 예제에서는 object로 Beer 클래스를 정의하고 동시에 인스턴스화했다.

println 메서드는 스칼라의 `문자열 보간법`이라는 기능을 보여준다. 문자열 보간법은 문자열 자체에 변수와 표현식을 바로 삽입하는 기능이다.

    자바에서는 보통 "Hello " + n + " bottles of bear"처럼 명시적으로 문자열과 변수를 연결해야 한다.

`함수형 스칼라`

같은 기능을 하는, 자바 코드와 스칼라 코드를 비교해보자

```java
IntStream.rangeClosed(2,6).forEach(n -> System.out.println("Hello "+n+" bottles of beer"));
```

```scala
2 to 6 foreach {n => println(s"Hello ${n} bottles of beer")}
```

스칼라 코드는 자바 코드보다 간결하다. 

스칼라 코드는 while루프처럼 변수를 갱신하지 않으므로 위 예제는 함수형이다.

`튜플`

안타깝게도 자바는 튜플을 지원하지 않는다. 따라서 직접 자료구조를 만들어야 한다.

스칼라는 튜플 축약어, 즉 간단한 문법으로 튜플을 만들 수 있는 기능을 제공한다.

```


val raul = ("Raul", "+ 44 8008988")
```

`클로저`

3장에서는 자바의 람다 표현식이 클로저에 해당하는지 여부를 알아봤다. 

클로저란 함수의 비지역 변수를 자유롭게 참조할 수 있는 함수의 인스턴스를 가리킨다.

하지만 자바의 람다 표현식에는 람다가 정의된 메서드의 지역 변수를 고칠 수 없다는 제약이 있다. 이들 변수는 암시적으로 final로 취급된다. 즉, `람다는 변수가 아닌 값을 닫는다`는 사실을 기억하자.

스칼라의 익명 함수는 값이 아니라 변수를 캡처할 수 있다.

```scala
val inc = () -> cnt+=1 // main 메서드에 있는 람다
```

만약 메인 메서드에 cnt가 있다면 inc에 있는 cnt는 메인 메서드의 cnt를 가리킨다.

하지만 자바로 구현한 코드는 암시적으로 final이 되므로 컴파일 에러가 발생한다.

```java
Runnable r1 = () -> cnt+=1 // 에러: cnt는 명시적으로 final 또는 final에 준하는 변수여야 함
```

---

`스칼라의 트레이트와 자바의 인터페이스`

스칼라는 트레이트라는 유용한 추상 기능을 제공한다. 스칼라의 트레이트는 자바의 인터페이스를 대체한다. 트레이트로 추상메서드와 기본구현을 가진 메서드 두가지를 모두 정의할 수 있다.

```scala
trait Sized{
    var size: Int = 0
    def isEmpty() = size == 0
}

class Empty extends Sized

println(new Empty().isEmpty())
```

---

### 마치며

자바와 스칼라는 객체지향과 함수형 프로그래밍 모두를 하나의 프로그래밍 언어로 수용한다. 두 언어 모두 JVM에서  실행되며 넓은 의미에서 상호운용성을 갖는다.

스칼라는 자바에 비해 풍부한 함수 관련 기능을 제공한다. 스칼라는 함수 형식, 지역 변수에 접근할 수 있는 클로저, 내장 커링 형식 등을 지원한다.

스칼라는 트레이트를 지원한다. 트레이트는 필드와 디폴트 메서드를 포함할 수 있는 인터페이스이다.