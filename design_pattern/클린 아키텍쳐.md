# 클린 아키텍처

---

## 목적

> 클린 아키텍처 뿐만 아니라,  
> 대부분의 아키텍처의 목적에 대해 설명한다.

### Independent of Frameworks

프레임워크에 의존하지 않는다.

> 프레임워크는 단지 도구일 뿐이다.

### Testable

테스트하기 쉽다.

> DB, UI, 외부 시스템 없이 비즈니스 로직을 테스트할 수 있다.

### Independent of UI, Database, External Agency

UI, DB, 외부 시스템에 의존하지 않는다.

> 현재의 UI, DB가 다른 것으로 바뀌더라도,  
> 비즈니스 로직은 바뀌지 않는다.

---

## 레이어 별 설명

엔티티가 가장 안쪽에 위치하고, 유즈케이스, 인터페이스 어댑터, 인프라스트럭처 순으로 외부로 나아간다.

### 엔티티(도메인) 레이어

핵심 비즈니스 규칙을 포함한다.

> 리워드, 쿠폰, 주문, 결제, 배송 등

### 유즈케이스 레이어

유즈케이스에 해당하는 비즈니스 규칙을 포함한다.

> 주문 유즈케이스, 결제 유즈케이스, 배송 유즈케이스 등

### 인터페이스 어댑터 레이어

외부 시스템과의 연동을 담당한다.

> 레포지토리, 컨트롤러, 뷰 등

### 인프라스트럭처 레이어

외부 시스템과의 연동을 담당한다.

> DB, Grpc, HTTP 등  
> 드라이버, 프레임워크, 라이브러리 등

---

## 레이어 간 의존성

엔티티 레이어는 다른 레이어에 의존하지 않는다.

유즈케이스 레이어는 엔티티 레이어에 의존한다.

인터페이스 어댑터 레이어는 유즈케이스 레이어에 의존한다.

인프라스트럭처 레이어는 인터페이스 어댑터 레이어에 의존한다.

> 바깥쪽의 레이어는 안쪽의 레이어에 의존할 수 있다.  
> 하지만 안쪽의 레이어는 바깥쪽의 레이어에 의존할 수 없다.

---

## 인터페이스 분리

유즈케이스는 DB에 있는 데이터가 필요할 때가 있다.  
이때 레포지토리 구현체를 직접 사용하면,  
유즈케이스는 레포지토리 구현체에 의존하게 된다.

> 고수준 모듈은 저수준 모듈에 의존해서는 안 된다.

이를 방지하기 위해 인터페이스를 분리한다.

### 인터페이스와 구현 객체는 각각 어떤 레이어에서 정의하는 게 좋을까?

인터페이스는  
`그것을 사용하는 레이어`에서 정의하는 것이 좋다.

### 레포지토리 예시 설명

인터페이스: 유즈케이스 레이어  
(유즈케이스가 레포지토리를 사용하기 때문)

구현 객체: 인프라스트럭처 레이어  
(레포지토리의 구현체는 DB, HTTP 등을 사용하기 때문)

### Grpc 예시 설명

인터페이스: 인터페이스 어댑터 레이어  
(인터페이스 어댑터 레이어가 Grpc를 사용하기 때문)